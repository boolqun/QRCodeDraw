[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=120
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=ec75a0c8-0f51-41f6-a6b2-819cab062cac
Description=2_二维码制作
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=FormMain
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
//********************************************************
//二维码制作
//对普通的二维码二次加工，让二维码信息输出到其他界面上。
//##########################################################################################
//在程序运行过程中，不要随意切换窗口，移动鼠标，按键盘，以免发生误操作
//在程序运行过程中，鼠标会长时间处于自动控制状态，参数的错误或者其他原因，都有可能会造成计算机故障，如电脑存有重要数据，请勿运行此程序
//程序来源于：布尔的布（微信公众号：boolqun）
//********************************************************
Dim imgFilePath	//图片文件存储路径
Dim imgMain//图片的主要对象
Dim imgPixels//图片的像素点数组
Dim imgSize //图片的大小{宽度，高度}
Dim QRCellSize//二维码的方块尺寸大小
Dim QRCellNumOffest//二维码的方块数量(行)补偿值
Dim QRStartPoint //起点坐标{x,y}//二维码
Dim QRColorTrue//真值的颜色//二维码
Dim QRColorFalse//假值的颜色//二维码
Dim QRPoints//坐标点数组{x,y}//二维码单元方块//
Dim QRBools//单元方块的逻辑数组//二维码单元方块//
Dim QRLength//方块数量（一条直线上）//二维码
Dim QRCellSizeNew//二维码的方块尺寸大小//新的二维码//
Dim QRMakeStartX,QRMakeStartY//新的起点（左上角）//制作二维码//开始时，鼠标的位置//

Event FormMain.BtnStart.Click
	If QRCellSize = 0 Then 
		MessageBox "未计算二维码参数和预览图片效果，请先点击“二维码预览刷新”按扭！"
		Exit Event
	End If
	QRCellSizeNew = int(FormMain.InCellSize.Text)//二维码的方块尺寸大小//新的二维码//
	If QRCellSizeNew < 5 Then 
		TracePrint "新的二维码的单元方块：尺寸太小，效果不明显，注意参数设置！"
	End If
	
	MsgBox "请打开画图窗口，然后关闭这个窗口"& VbCrLf &"在3秒内，将鼠标放在起点处"& VbCrLf &"程序倒数3秒后，就自动开始画图。。"
	Call TimeDown(3)	//倒计时//子程序
    EndScript
    //把当前鼠标位置的x和y坐标放在变量中 
    GetCursorPos QRMakeStartX,QRMakeStartY//新的起点（左上角）//制作二维码//开始时，鼠标的位置//
    Call QRMake()	//二维码制作//二维码单元方块/
    EndScript
	
	MsgBox "二维码绘制完成"
	TracePrint "二维码二次制作结束****************************************"
End Event

Event FormMain.BtnShow.Click
	If FormMain.ImgFile.Path = "" Then 
		MessageBox "未选择任何图片，请先选择二维码图片！"
		Exit Event
	End If
	imgFilePath = FormMain.ImgFile.Path//图片文件存储路径
	QRColorTrue = Array(int(FormMain.InTrueMin.Text)  ,int(FormMain.InTrueMax.Text) )//真值的颜色//二维码
	QRColorFalse = Array(int(FormMain.InFalseMin.Text), int(FormMain.InFalseMax.Text))//假值的颜色//二维码
	QRCellNumOffest = int( FormMain.InCellOffest.Text )//二维码的方块数量(行)补偿值
	
	Call GetImgPixels()	//获取图片的像素组//子程序
	EndScript
	Call GetStartPoint() //获取第一个像素点（左上角）//二维码//子程序
	EndScript
	Call GetCellSize() //单个方块的尺寸大小//二维码//子程序
	EndScript
	Call GetSignPoints() //获取坐标点数组//二维码单元方块/
	EndScript
	Call ShowSignPoints() //显示坐标点数组//二维码单元方块/
	EndScript
	TracePrint "二维码图片刷新预览结束##############################################"
End Event


//二维码制作//二维码单元方块/
Sub QRMake()
	Dim tPointX,tPointY	//临时坐标
	//QRPoints//坐标点数组{x,y}//二维码单元方块//
	//QRBools//单元方块的逻辑数组//二维码单元方块//
	For m = 0 To UBound(QRBools)
		If QRBools(m) = True Then 
			//QRMakeStartX//QRMakeStartY//新的起点（左上角）//制作二维码//开始时，鼠标的位置//
			//QRCellSizeNew//二维码的方块尺寸大小//新的二维码//
			tPointX = QRMakeStartX + QRPoints(m,0)*QRCellSizeNew	//临时坐标
			tPointY = QRMakeStartY + QRPoints(m,1)*QRCellSizeNew	//临时坐标
			//鼠标和键盘执行动作//二维码制作//二维码单元方块/
			Call QRMakeRun(tPointX,tPointY,QRCellSizeNew,QRCellSizeNew,100)
			EndScript
		End If
	Next

End Sub

//鼠标和键盘执行动作//二维码制作//二维码单元方块/
Function QRMakeRun(tMouseX,tMouseY,tOffestX,tOffestY,tTime)
 	MoveTo tMouseX, tMouseY//把鼠标移动到这个点上 
 	Delay tTime 
 	LeftDown 1//在当前鼠标的位置按下鼠标左键  
 	MoveTo tMouseX+tOffestX, tMouseY+tOffestY//把鼠标移动到这个点上 
 	Delay tTime
 	LeftUp 1//在当前鼠标的位置弹起鼠标左键
 	Delay tTime
 	////QRMakeStartX//QRMakeStartY//新的起点（左上角）//制作二维码//开始时，鼠标的位置//
 	MoveTo QRMakeStartX-20, QRMakeStartY//把鼠标移动到这个点上 
 	//MoveTo tMouseX+tOffestX+20, tMouseY+tOffestY+20//把鼠标移动到这个点上 
 	Delay tTime
 	LeftClick 1   //在当前鼠标的位置单击鼠标左键1次 
End Function

//获取坐标点数组//二维码单元方块/
Sub GetSignPoints()
	Dim tempIndex //临时索引
	Dim tempColor//临时颜色
	Dim tStartPoint(2) //临时起点{x,y}
	ReDim QRPoints(QRLength*QRLength,2)//坐标点数组{x,y}//二维码单元方块//
	ReDim QRBools(QRLength*QRLength)//单元方块的逻辑数组//二维码单元方块//
	
	tStartPoint(0) = (QRStartPoint(0) + QRCellSize/2) //临时起点{x,y}
	tStartPoint(1) = (QRStartPoint(1) + QRCellSize/2) //临时起点{x,y}
	//QRLength//方块数量（一条直线上）//二维码
	For row = 0  To QRLength-1 step 1
		For col = 0  To QRLength - 1 step 1
			tempIndex = int( tStartPoint(1) + QRCellSize*row ) * imgSize(0)+int( tStartPoint(0) + QRCellSize*col) + 1//临时索引
			tempColor = (imgPixels( tempIndex ) AND &H00FFFFFF) //临时颜色
			//ValueInRange()//数值在范围内//返回true为在范围内//子程序
			//QRColorTrue//真值的颜色////QRColorFalse//假值的颜色//
			If ValueInRange(tempColor, QRColorTrue(0), QRColorTrue(1)) Then 
				imgPixels(tempIndex) = ((&hff0000) or &hff000000)
				QRBools(QRLength*row + col) = True //单元方块的逻辑数组//二维码单元方块//
				//TracePrint "真" & imgPixels(tempIndex) &"  "&  tempColor
			ElseIf ValueInRange(tempColor, QRColorFalse(0), QRColorFalse(1)) Then
				imgPixels(tempIndex) = ((&h0000ff) or &hff000000)
				QRBools(QRLength*row + col) = False //单元方块的逻辑数组//二维码单元方块//
				//TracePrint "假" & imgPixels(tempIndex) &"  "&  tempColor
			End If
			QRPoints(QRLength * row + col, 0) = col//坐标点数组{x,y}//二维码单元方块//
			QRPoints(QRLength*row+col,1) = row//坐标点数组{x,y}//二维码单元方块//
		Next
	Next
	TracePrint "完成二维码单元方块坐标点的获取"
End Sub

//显示坐标点数组//二维码单元方块/
Sub ShowSignPoints()
	Dim tImgDirPath//临时文件夹路径
	Dim tImgFilePathNew//临时图片存储路径
	Dim tLength//临时数组长度
	//保存图片，显示图片效果
	TracePrint "正在生成预览图片，需要一定时间，请稍等、、、"
	Set tImgNewVector = CreateObject("WIA.Vector")//图片的像素向量数组
	tLength = imgSize(0)*imgSize(1)//临时数组长度
	For t = 1 To tLength
		tImgNewVector.Add(imgPixels(t))
	Next
	tImgDirPath = Left(imgFilePath, InstrRev(imgFilePath, "\", - 1 , 1)) & "二维码_临时文件夹" //图片文件的文件夹
	If Not Lib.文件.判断文件夹是否存在(tImgDirPath ) Then 
		Call Plugin.File.CreateFolder(tImgDirPath )
	End If
	tImgFilePathNew = tImgDirPath & "\" & Replace(Now, ":", "") & "." & imgMain.FileExtension//图片文件存储路径(新的效果图片)
	Set tImgNew = tImgNewVector.ImageFile(imgSize(0), imgSize(1))
	tImgNew.SaveFile tImgFilePathNew
	FormMain.ImgShow.Picture = tImgFilePathNew
	TracePrint "完成标记点图片预览"
End Sub

//获取图片的像素组//子程序
Sub GetImgPixels()
	//利用WIA图片处理方法//Windows Image Acquisition
	Set imgMain = CreateObject("WIA.ImageFile")
	imgMain.LoadFile imgFilePath
	Set imgPixels = imgMain.ARGBData
	imgSize = Array(imgMain.width,imgMain.height) //图片的大小{宽度，高度}
 	//TracePrint imgPixels.Count //TracePrint Hex(imgPixels(i))
 	FormMain.ImgShow.Picture =  imgFilePath
End Sub 

//单个方块的尺寸大小//二维码//子程序
Sub GetCellSize()
	Dim tempColor//临时颜色
	Dim tRowEndPoint//行的最后一点//临时变量//
	Dim tKeySize//位置探测方块大小//临时变量//
	
	tKeySize =0  //位置探测方块大小//临时变量//
	For row = 0 To imgSize(1)-1
		For col = imgSize(0)-1 To 0 step -1
			tempColor = (imgPixels( row * imgSize(0) + col + 1 ) AND &H00FFFFFF) //临时颜色
			//ValueInRange()//数值在范围内//返回true为在范围内//子程序
			//QRColorTrue//真值的颜色////QRColorFalse//假值的颜色//
			If ValueInRange(tempColor, QRColorTrue(0), QRColorTrue(1))  Then 
				If tKeySize = 0 Then 
					tRowEndPoint = Array(col, row)//行的最后一点//临时变量//
					TracePrint "二维码右上角终点点坐标 " & tRowEndPoint(0) & "  " & tRowEndPoint(1)
				End If
				tKeySize = tKeySize + 1 //位置探测方块大小//临时变量//
			ElseIf tKeySize > 0 Then
				TracePrint "二维码定位区方块大小粗算： " & tKeySize
				Goto 	标记_计算方块大小
			End If
		Next
	Next
	
	Rem 标记_计算方块大小
	QRLength =  ( Round((tRowEndPoint(0)-QRStartPoint(0))/(tKeySize/7))  +QRCellNumOffest) //方块数量（一条直线上）//二维码
	//计算二维码的方块尺寸大小
	//QRCellNumOffest//二维码的方块数量(行)补偿值
	QRCellSize = (tRowEndPoint(0)-QRStartPoint(0)) / QRLength
	TracePrint "二维码单元方块数量（行）： " & (QRLength)
	TracePrint "二维码单元方块大小" & QRCellSize
End Sub

//获取第一个像素点（左上角）//二维码//子程序
Sub GetStartPoint()
	Dim tempColor//临时颜色
	For row = 0 To imgSize(1)-1
		For col = 0 To imgSize(0)-1
			tempColor = (imgPixels( row * imgSize(0) + col + 1 ) AND &H00FFFFFF) //临时颜色
			//ValueInRange()//数值在范围内//返回true为在范围内//子程序
			//QRColorTrue//真值的颜色////QRColorFalse//假值的颜色//
			If ValueInRange( tempColor,QRColorTrue(0),QRColorTrue(1) ) Then 
				QRStartPoint = Array(col, row)//起点坐标{x,y}//二维码
				TracePrint "二维码左上角起点坐标 " & QRStartPoint(0) & "  "& QRStartPoint(1)
				Exit Sub
			End If
		Next
	Next
End Sub 


//数值在范围内//返回true为在范围内//子程序
Function ValueInRange(tNum,tMin,tMax)
	If tNum >= tMin and tNum <= tMax Then 
		ValueInRange = true
	Else 
		ValueInRange = False
	End If
End Function


//倒计时//子程序
Function TimeDown(tNum)
	Dim tTimeCount
	set tTimeCount = CreateObject("SAPI.SpVoice")
	For t = 1 To tNum
		tTimeCount.Speak CStr(t)
		Delay 1000//{延时}里面填写”毫秒”数 
	Next
	tTimeCount.Speak "Go"
End Function